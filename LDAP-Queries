#Domain Enumeration

#Group Membership
([ADSISEARCHER]"samaccountname=$('ENTERUSERNAME')").Findone().Properties.memberof -replace '^CN=([^,]+).+$','$1' | sort-object



To test
# Find all users with given name Pawel
([adsisearcher]"givenname=pawel").FindAll()
 
# Find users based on other attibutes
([adsisearcher]"(&(objectClass=User)(surname=janowicz))").FindAll()
([adsisearcher]"(&(objectClass=User)(city=Warsaw))").FindAll()
([adsisearcher]"(&(objectClass=User)(mobile=+48555444333))").FindOne()
 
# Find user based on name and display all properties
([adsisearcher]"(&(objectClass=person)(objectClass=user)(name=pawel.janowicz))").FindAll().properties


([adsisearcher]"(&amp;(objectcategory=computer)(lastlogontimestamp<=$((Get-Date).AddDays(-105).ToFileTime())))").findall()

# Filters for all privileged accounts.
([adsisearcher]”(&(admincount=1))”).FindAll() [PowerShell]

# Enumerates all of the crackable service accounts. (Works well no need to import modules)
([adsisearcher]”(&(objectClass=User)(primarygroupid=513)(servicePrincipalName=*))”).FindAll() | ForEach-Object { “Name:$($_.properties.name)””SPN:$($_.properties.serviceprincipalname)””Path:$($_.Path)”””}

# Gives us all attributes associated with a particular computer.
(([adsisearcher]”(name=Computer)”).FindAll()) | Select -Expand Properties

# View Users with Description Field
([adsisearcher]"(&(objectClass=group)(samaccountname=*))").FindAll().Properties | % { Write-Host $_.samaccountname : $_.description } 
